<article>
  <title>Swarm intelligence-based extremum seeking control</title>
  <abstract>
    <sentence>This paper proposes an extremum seeking control (ESC) scheme based on particle swarm optimization (PSO).</sentence>
    <sentence>In the proposed scheme, the controller steers the system states to the optimal point based on the measurement, and the explicit form of the performance function is not needed.</sentence>
    <sentence>By measuring the performance function value online, a sequence, generated by PSO algorithm, guides the regulator that drives the state of system approaching to the set point that optimizes the performance.</sentence>
    <sentence>We also propose an algorithm that first reshuffles the sequence, and then inserts intermediate states into the sequence, in order to reduce the regulator gain and oscillation induced by population-based stochastic searching algorithms.</sentence>
    <sentence>The convergence of the scheme is guaranteed by the PSO algorithm and state regulation.</sentence>
    <sentence>Simulation examples demonstrate the effectiveness and robustness of the proposed scheme.</sentence>
  </abstract>
  <keywords>
    <keyword>Particle swarm optimization</keyword>
    <keyword>Extremum seeking control</keyword>
    <keyword>State regulation</keyword>
    <keyword>Adaptive control</keyword>
    <keyword>Swarm intelligence-based optimization</keyword>
  </keywords>
  <section name="Introduction">
    <sentence>Regulation and tracking of system states to optimal setpoints or trajectories are typical tasks in control engineering.</sentence>
    <sentence>However, these optimal setpoints are sometimes difficult to be chosen a priori, or vary with the environmental condition changes.</sentence>
    <sentence>Extremum seeking control (ESC) is a kind of adaptive control schemes that can search for the optimal setpoints online, based on the measurement of the performance output or its gradient.</sentence>
    <sentence>ESC can be regarded as an optimization problem, and many of the schemes used in ESC are transferred from optimization algorithms.</sentence>
    <sentence>However, some optimization algorithms cannot be incorporated into the ESC framework easily, for the reason that, practical issues, such as stability, noise, regulation time, control gain and oscillation limitation, will prevent the use of some optimization algorithms from ESC context.</sentence>
    <sentence>Thus, the study on suitable combination of ESC and optimization algorithms is of great interest both in academics and in engineering.</sentence>
    <sentence>Unlike the traditional variational calculus-involved optimal control method, the explicit form of the performance function is not needed in ESC.</sentence>
    <sentence>Therefore, ESC is useful in the applications that the performance functions are difficult to model.</sentence>
    <sentence>After Krstic and Wang’s stability studies (Krstic &amp; Wang, 2000), research on ESC has received significant attention in recent years.</sentence>
    <sentence>The recent ESC application examples include active flow control (Beaudoin, Cadot, Aider, &amp; Wesfreid, 2006), bioreactor or chemical process control (Bastin, Nescaroni, Tan, &amp; Mareels, 2009; Hudon, Guay, Perrier, &amp; Dochain, 2008; Hudon, Perrier, Guay, &amp; Dochain, 2005), cascaded Raman optical amplifiers (Dower, Farrell, &amp; Nesic, 2008), antilock braking system design (Zhang &amp; Ordonez, 2007), thermoacoustic cooler (Li, Rotea, Chiu, Mongeau, &amp; Paek, 2005), and fuel cell power plant (Zhong, Huo, Zhu, Cao, &amp; Ren, 2008).</sentence>
    <sentence>There also have been considerable theoretical studies in ESC, such as stability studies on perturbation-based ESC (Krstic, 2000; Krstic &amp; Wang, 2000), ESC for discrete-time systems (Joon-Young, Krstic, Ariyur, &amp; Lee, 2002), PID tuning by ESC (Killingsworth &amp; Krstic, 2006), ESC for nonlinear dynamic systems with parametric uncertainties (Guay &amp; Zhang, 2003), and ESC for state-constrained nonlinear systems (DeHaan &amp; Guay, 2005).</sentence>
    <sentence>The majority of ESC literature focused on two issues, the one is the searching for the optima, and the other is the regulation of the systems.</sentence>
    <sentence>The recent studies of Zhang and Ordonez (2007, 2009) presented a numerical optimization-based ESC (NOESC) framework that takes the advantage of numerical algorithms to find the optima online.</sentence>
    <sentence>However, these algorithms are unable to find the global optima if the assumption that the performance functions are convex and continuous does not hold.</sentence>
    <sentence>Furthermore, the NOESC is sensitive to measurement noise, due to the poor robustness of the numerical algorithms.</sentence>
    <sentence>Particle swarm optimization (PSO) algorithm is a population-based stochastic optimization method which first devised by Kennedy and Eberhart (1995).</sentence>
    <sentence>PSO algorithm mimics the food-seeking behavior of birds or fishes.</sentence>
    <sentence>Due to its simplicity and effectiveness, PSO algorithm witnesses a considerable interest and is applied in many areas.</sentence>
    <sentence>The convergence of PSO algorithm is studied by deterministic method (Eberhart &amp; Shi, 2001) or stochastic process theory (Jiang, Luo, &amp; Yang, 2007).</sentence>
    <sentence>Clerc and Kennedy (2002) presented a convergence condition of PSO algorithm.</sentence>
    <sentence>Rapaic and Kanovic (2009) studied the time-varied parameter PSO algorithm and the selection of the parameters.</sentence>
    <sentence>Studies have shown that PSO algorithm is able to handle a wide range of problems, such as integer optimization (Laskari, Parsopoulos, &amp; Vrahatis, 2002), multi-objective optimization (Dasheng, Tan, Goh, &amp; Ho, 2007), and global optimization of multimodal functions (Liang, Qin, Suganthan, &amp; Baskar, 2006).</sentence>
    <sentence>The recent application of PSO algorithm includes power systems (del Valle, Venayagamoorthy, Mohagheghi, Hernandez, &amp; Harley, 2008), flights control (Duan, Ma, &amp; Luo, 2008), and nuclear power plants (Meneses, Machado, &amp; Schirru, 2009), to name a few.</sentence>
    <sentence>In control engineering, PSO algorithm is usually employed to identify the models (Panda, Mohanty, Majhi, &amp; Sahoo, 2007), or to optimize the parameters of the controller offline (El-Zonkoly, 2006).</sentence>
    <sentence>PSO algorithm is usually regarded as an effective global optimization method.</sentence>
    <sentence>However, it is often used in offline optimization, and depends on the explicit form and the solvability of the performance functions.</sentence>
    <sentence>However, for some complex models, e.g.</sentence>
    <sentence>active flow control problems which described by Navier–Stokes equations, it is difficult to obtain the optimal parameters of the controllers by time-consuming numerical simulations.</sentence>
    <sentence>In this paper, we extend the numerical optimization-based ESC (Zhang &amp; Ordonez, 2007) by incorporating PSO algorithm into the extremum seeking framework.</sentence>
    <sentence>We also address the practicability issues of this scheme, and propose a reshuffle-then-insertion algorithm to reduce the control gain and oscillation.</sentence>
    <sentence>In the proposed scheme, a sequence converging to the global optima is generated by PSO with reshuffle-then-insertion algorithm.</sentence>
    <sentence>The sequence used as a guidance to regulate the state of the plant approach to the optimal set point.</sentence>
    <sentence>This paper is organized as follows.</sentence>
    <sentence>Section 2 gives a problem statement, where a PSO-based ESC (PSOESC) framework is introduced.</sentence>
    <sentence>We then review the standard PSO algorithm in Section 3.</sentence>
    <sentence>The details of the PSOESC scheme for linear time invariant (LTI) systems and feedback linearizable systems are presented in Section 4, where the reshuffle-then-insertion approach for improving the practicability of the PSOESC is also proposed.</sentence>
    <sentence>Section 5 presents the results of the numerical experiments.</sentence>
    <sentence>Finally, Section 6 concludes the paper.</sentence>
  </section>
  <section name="Problem statement">
    <sentence>In control practice, the problem of seeking for an optimal set point is encountered usually.</sentence>
    <sentence>In general, this problem can be represented as model (1) (2) where is the state, is the input, is the performance output to be optimized, is a sufficiently smooth function on D, and is an unknown function.</sentence>
    <sentence>For simplicity, we assume in this paper.</sentence>
    <sentence>Without loss of generality, we consider the minimization of the performance function (2).</sentence>
    <sentence>Unlike optimal control, extremum seeking control finds the optimal set point by online measurement of the performance function, without the knowledge of its explicit form.</sentence>
    <sentence>ESC can be considered as a class of constrained optimization problem whose constraint is the differential Eq (1), instead of the algebraic constrains in traditional optimization problems.</sentence>
    <sentence>Then, ESC control problem can be stated as: (3) When (1) is controllable, there always exists a control u such that state x transfers to any position in in a finite time.</sentence>
    <sentence>We then can apply any optimization algorithm to produce a guidance sequence to determine a trajectory to the optimal set point in the state space (Zhang &amp; Ordonez, 2007).</sentence>
    <sentence>Similar to numerical optimization-based ESC (Zhang &amp; Ordonez, 2009), we present a PSO-based ESC block diagram as Fig 1, where the nonlinear plant is modeled as (1) and the performance function J is (2).</sentence>
    <sentence>Unlike Zhang &amp; Ordonez, 2009, we apply PSO algorithms to substitute the numerical optimization algorithms to produce the extremum seeking sequence {Xk}.</sentence>
    <sentence>The sequence {Xk} is generated as the target state in every seeking iterative step, based on the online measurement of y.</sentence>
    <sentence>The regulator K regulates the state of F follows the sequence as X1, X2, …, Xk, toward the optimal set point.</sentence>
    <sentence>PSO-based extremum seeking block diagram Fig 1.</sentence>
    <sentence>PSO-based extremum seeking block diagram.</sentence>
  </section>
  <section name="Particle swarm optimization">
    <sentence>PSO is a population-based random optimization algorithm that mimics the behavior of bird or fish swarm in searching food.</sentence>
    <sentence>In the swarm, each particle has a variable speed, moving toward the positions of its own best fitness achieved so far and the best fitness achieved so far by any of its neighbors.</sentence>
    <sentence>Let is an n-dimensional search space.</sentence>
    <sentence>The size of the particle swarm is denoted as N. The position of the ith particle is represented as an n-dimensional vector , and its velocity is denoted as Vi = (vi1, vi2, …, vin)T ∈ S, where i = 1, 2, …, N is the identity of each particle.</sentence>
    <sentence>The best position it has achieved so far is .</sentence>
    <sentence>The best position achieved so far in its neighborhood is Pgbst.</sentence>
    <sentence>On the time step k, the update equation of the basic PSO algorithm is (Kennedy &amp; Eberhart, 1995) (4) (5) where, c is an acceleration coefficient, r1, r2 are two independent random numbers with uniform distribution in the range of [0, 1].</sentence>
    <sentence>Though this version of PSO has been shown to perform well in some optimization cases, it is not suitable in ESC context for its possible explosion property will lead to an unfeasible large control gain.</sentence>
    <sentence>Clerc and Kennedy (2002) suggested a PSO algorithm which is known as the standard PSO, by introducing constriction coefficient χ.</sentence>
    <sentence>The update equation in the standard PSO is (6) (7) where χ, φ1, φ2 are nonnegative constant real numbers.</sentence>
    <sentence>Obviously, by choosing appropriate parameters, (6) can transform to (8) where ω, c1, c2 are nonnegative constant real numbers.</sentence>
    <sentence>The velocity update Eq (8) has three major components.</sentence>
    <sentence>The first component is referred to as “inertia” for it models the tendency of the particle to continue in the same direction it has been traveling.</sentence>
    <sentence>The second component is referred to as “memory” for it models the moving towards the best position ever found by the given particle.</sentence>
    <sentence>The third component is referred to as “cooperation” for it models the moving towards the best position by particles in neighborhood (del Valle et al., 2008).</sentence>
    <sentence>From the formulation above, the standard PSO algorithm can be described as Algorithm 1 Standard PSO algorithm Step (1) Initialize the swarm by assigning a random position to each particle.</sentence>
    <sentence>Step (2) Evaluate the fitness function for each particle.</sentence>
    <sentence>Step (3) Identify the best position of each particle.</sentence>
    <sentence>Step (4) Identify the best position Pgbst.</sentence>
    <sentence>Step (5) Update the velocities and positions of all the particles using (6)or (8) and (7).</sentence>
    <sentence>Step (6) Repeat (2)–(5), until a stop criterion is met.</sentence>
    <sentence>Because the positions of particles involve randomness, the convergence of PSO-involved algorithms is defined in a possibility sense in this paper.</sentence>
    <sentence>We say Xi(k) converges in mean square to Q∗, when , for ∀i ∈ {1, 2, …, N}, where N is the population size of the swarm, and E represents the expectation operator.</sentence>
    <sentence>Theorem 1 Given ω, c1, c2, when , c1 + c2 &gt; 0, and, where, and , are all satisfied, then the particle systems driven byAlgorithm 1will converge in mean square to Pgbest.</sentence>
    <sentence>Proof Refer to the Theorem 5 in Jiang et al.</sentence>
    <sentence>(2007).</sentence>
    <sentence>□ Remark 1 Theorem 1 shows that the standard PSO algorithm guarantees every particle converges in mean square to the best position of the whole swarm.</sentence>
    <sentence>However, that position may not be the global optima or the local optima.</sentence>
    <sentence>There are modified PSOs that converge in mean square to local optima (van den Bergh &amp; Engelbrecht, 2002) or global optima (Xin &amp; Yangmin, 2007).</sentence>
    <sentence>In order to ensure the convergence to the optimal value, modified PSO algorithms need to make tradeoffs between exploration and exploitation, and numerous papers have presented various modified PSOs for this issue (Rapaic &amp; Kanovic, 2009; van den Bergh &amp; Engelbrecht, 2002; Xin &amp; Yangmin, 2007; Zihui et al., 2008).</sentence>
    <sentence>For simplicity, in the following section we will focus on standard PSO algorithm, assuming that the standard PSO algorithm can converge in mean square to the global optima in the ESC cases.</sentence>
    <sentence>For the same reason, we also drop the “mean square” in the convergence analysis.</sentence>
  </section>
  <section name="PSO-based extremum seeking scheme">
    <sentence>Similar to Zhang and Ordonez (2007), we discuss the PSO-based extremum seeking control scheme in the order of linear time-invariant systems (LTI), feedback linearizable systems, and input-output feedback linearizable systems.</sentence>
    <sentence>PSOESC for LTI systems Consider a single-input-single-output (SISO) linear time-invariant system (9) with the performance function defined as (2).</sentence>
    <sentence>The matrices A and B are given, while J is unknown.</sentence>
    <sentence>We will find the minimum of J online by the measurement of the function value y.</sentence>
    <sentence>To do this, the following assumption is needed to ensure the feasibility of ESC for the LTI system (9).</sentence>
    <sentence>Assumption 1 The LTI system (9) is controllable.</sentence>
    <sentence>From the linear system theory, we have the following lemma that states the existence of a perfect regulator.</sentence>
    <sentence>Lemma 1 For LTI system(9), whenAssumption 1holds, given system statex(tk) on timetk, regulation timeδk, andXk+1, lettk+1 = tk + δk, the control input (10) where (11) thenx(tk+1) = Xk+1.</sentence>
    <sentence>Proof From the assumption, the LTI system (9) is controllable, then the controllability Gramian G(δk) is nonsingular, thus the control input (10) is feasible.</sentence>
    <sentence>From linear system theory, the solution of (9) gives (12) Then, substituting (10) into (12) will complete the proof.</sentence>
    <sentence>□ Remark 2 From Lemma 1, there always exists a control u that regulates the state to any given state from any initial state, provided the LTI system is controllable.</sentence>
    <sentence>Thus, we can device a scheme that drives the state of the system to the global optima along a sequence produced by any optimization algorithms including that of swarm intelligence-based.</sentence>
    <sentence>By combining the Algorithm 1 and ESC, the PSO-based ESC scheme can be formed as follows.</sentence>
    <sentence>Algorithm 2 PSO-based ESC scheme for LTI systems Step (1) Initialize the particle swarm, and let i = 1, k = 1.</sentence>
    <sentence>Step (2) Let particle i’s position as the ith target state, i.e.</sentence>
    <sentence>let in (10) to get the control u.</sentence>
    <sentence>Step (3) The u regulates the plant to the target state, and the performance output y is readily to be measured by sensors.</sentence>
    <sentence>Step (4) Let the output y be the fitness of the particle.</sentence>
    <sentence>Step (5) Let i = i + 1, repeat 2–4, until i = N, where N is the predefined size of the particle swarm.</sentence>
    <sentence>Step (6) Update the velocity and position according to (6) and (7).</sentence>
    <sentence>Step (7) Let k = k + 1, repeat 2–5, until a stop criterion is met.</sentence>
    <sentence>We say (2)–(4) is a PSO loop, and (2)–(7) an ESC loop.</sentence>
    <sentence>The convergence result of Algorithm 2 can be shown by Lemma 1 and Theorem 1, and is presented as the following theorem.</sentence>
    <sentence>Theorem 2 Let X∗ be the solution of optimization problem(3), i.e.</sentence>
    <sentence>, if the solution of problem obtained byAlgorithm 1converges to X∗, thenAlgorithm 2drives system(9)to its minimum performance function value J∗.</sentence>
    <sentence>Proof Let denote the position of the ith particle on the kth ESC loop step.</sentence>
    <sentence>The PSO scheme described as Algorithm 1 produces a sequence (13) in k steps.</sentence>
    <sentence>From Theorem 1, the sequence converges to Pgbest, and from the assumption in the statement of Theorem 2 we also have Pgbest = X∗, when k → ∞.</sentence>
    <sentence>□ Let x(t0) denote the state of LTI system (9) at time t = t0.</sentence>
    <sentence>From Algorithm 2, we have the target state .</sentence>
    <sentence>Then, at time t1 = t0 + δ0, from Lemma 1, we will have .</sentence>
    <sentence>For the same reason, we also have .</sentence>
    <sentence>By induction, at the Kth ESC loop, we suppose , where i = 1, 2, …, N. Then, at the (K + 1)th ESC loop, from the Lemma 1, we will have (14) where (15) (16) For the same reason, we will have , where i = 1, 2, …, N. Thus, the Algorithm 2 guarantees that the state of system (9) follows exactly the sequence Therefore, the performance output of system (9) converges to its minimum value J∗.</sentence>
    <sentence>Remark 3 Since the standard PSO algorithm and its variants (del Valle et al., 2008; Xin &amp; Yangmin, 2007) have shown their effectiveness in global optimization problems, it is safe to assume Algorithm 2 converge to the global optima in ESC.</sentence>
    <sentence>Thanks to the global searching ability of PSO algorithm, we need not apply the assumptions in Zhang and Ordonez (2007) to ensure the global convergence condition for the numerical-based optimization algorithms.</sentence>
    <sentence>The performance function J can be nonconvex and discontinuous in ESC context now.</sentence>
    <sentence>Remark 4 Due to the population-based feature of PSO algorithms, one may think that the use of PSO would require N sensors, or plants, able to provide N simultaneous measurements of J every time a new element in the optimization sequence is needed.</sentence>
    <sentence>However, this is not the case, since Algorithm 2 ensures that we can track each state represented by a particle in the swarm in a serial manner, thus the sensors needed in PSOESC are no more than other ESCs.</sentence>
    <sentence>It should be noted that, compared to NOESC, PSOESC have to spend more time to obtain the best state in an ESC loop.</sentence>
    <sentence>However, this cost can be regarded as the expense paid for the global optima.</sentence>
    <sentence>For example, in some active flow control cases, the plants keep working for a long period, and the drag reduction obtained by ESC would be great beneficial (Beaudoin et al., 2006), so it is reasonable to spend some time to find the global optima.</sentence>
    <sentence>Remark 5 The Algorithm 2 requires a regulator to drive the state of the system (9) from one to another along the sequence produced by the PSO loop.</sentence>
    <sentence>However, due to the randomness feature of the update equation (6), at some stages, the regulator gain may be very large, and the state of the system would oscillate rashly.</sentence>
    <sentence>This could cause serious problems in real-world applications.</sentence>
    <sentence>This difficulty may hinder PSO or any other swarm intelligence-based algorithms from being applied in the ESC context.</sentence>
    <sentence>We will address this issue in Section 4.4, and provide an algorithm that rearranges the sequence to reduce the control gain and oscillation.</sentence>
    <sentence>Remark 6 It is not difficult to extend the Algorithm 2 to the multi-input-multi-output (MIMO) systems, like the NOESC schemes presented in Zhang and Ordonez (2007).</sentence>
    <sentence>Moreover, other design of controller (10) can be applied for a more robust regulator as suggested in Zhang and Ordonez (2007, 2009).</sentence>
    <sentence>PSOESC for feedback linearizable systems Consider a SISO nonlinear affine system (17) with the performance function defined as (2), where f and g are smooth functions on D. Assuming the system (17) is feedback linearizable on D, we have that there exists a diffeomorphism such that Dz = T(D) contains the origin, and transforms the system (13) into the form (Khalil, 2002) (18) where z = T(x), and (A, B) is controllable, γ(x) is nonsingular for all x ∈ D. Then, we can extend the results on LTI system in 4.1 to the feedback linearizable system (17).</sentence>
    <sentence>Let Zk+1 = T(Xk+1), then we can design a regulator (19) where (20) (21) such that the state of system (17) transfers from x(tk) to Xk+1 in a finite time δk.</sentence>
    <sentence>Then, we have the PSOESC scheme for the feedback linearizable system (17), represented as the following algorithm.</sentence>
    <sentence>Algorithm 3 PSOESC scheme for feedback linearizable systems Step (1) Initialize the particle swarm, and let i = 1, k = 1.</sentence>
    <sentence>Step (2) Let particle i’s position as the target state, i.e.</sentence>
    <sentence>let , then let Zk+1 = T(Xk+1) to get the control u by (15).</sentence>
    <sentence>Step (3) The u regulates the plant to the target state, and the performance output y is readily to be measured by sensors.</sentence>
    <sentence>Step (4) Let the output y be the fitness of the particle.</sentence>
    <sentence>Step (5) Let i = i+1, repeat 2–4, until i = N, where N is the predefined size of the particle swarm.</sentence>
    <sentence>Step (6) Update the velocity and position according to (6) or (8) and 7.</sentence>
    <sentence>Step (7) Let k = k + 1, repeat 2–5, until a stop criterion is met.</sentence>
    <sentence>The convergence analysis mainly follows the proof of Theorem 2.</sentence>
    <sentence>Similar remarks like 3–6 in Section 4.1 also apply here.</sentence>
    <sentence>PSOESC for input–output feedback linearizable systems The results on state feedback linearizable systems in Section 4.2 can be extend to input-output feedback linearizable systems by substituting the regulator with appropriate designs, in a similar way as NOESC.</sentence>
    <sentence>The details refer to Zhang and Ordonez (2007).</sentence>
    <sentence>Regeneration of the sequence produced by the PSO algorithm As indicated by Remark 5, tracing the sequence produced by the standard PSO algorithm would cause serious problems in practice.</sentence>
    <sentence>The sequence has to be regenerated to suit ESC context.</sentence>
    <sentence>Without loss of generality, we discuss the regeneration of the sequence produced by Algorithm 2 presented in Section 4.1.</sentence>
    <sentence>Consider system (6), and the state from time tk to tk+1.</sentence>
    <sentence>From (10), the output of the regulator in a state transfer procedure is determined by the regulation time δk = xk+1 − xk, the initial state x(tk), and the terminal state x(tk+1).</sentence>
    <sentence>Given the regulation time δk, if we want to minimize the maximum control, then we need an algorithm to reshuffle the sequence {xk} to minimize the .</sentence>
    <sentence>However, the optimal regeneration is difficult to devise because it is NP-hard as Problem 1 shows.</sentence>
    <sentence>Problem 1 Let G = {V, E} be a complete weighted graph, where V = {1, 2, …, N} is the vertex set, indicating the states in sequence , and E is the edge set.</sentence>
    <sentence>We also denote D as the distance matrix, where D = [di,j]N×N, and (22) (23) Now, the searching for the optimal sequence is equivalent to solve the programming problem represented as: (24) where, |S| is the number of the vertices contained in G in S. The Problem 1 is also known as the bottleneck traveling salesman problem (BTSP), and is shown NP-hard (Kabadi, 2002), i.e.</sentence>
    <sentence>there is no polynomial algorithm for this kind of problems so far.</sentence>
    <sentence>We propose here an algorithm to regenerate the PSO-produced sequence for the practical use of PSOESC, based on the following consideration.</sentence>
    <sentence>In practice, limiting maximum control gain within a certain bound is sufficient to have a practical controller.</sentence>
    <sentence>From (10), we have that for each predefined Σ &gt; 0, there always exists a regulation time δk such that ||u(t)|| &lt; Σ.</sentence>
    <sentence>Therefore, the control gain can be limited in a bound by choosing a sufficiently long regulation time δk.</sentence>
    <sentence>However, too long regulation time may be unacceptable in practice.</sentence>
    <sentence>Another feasible approach is to insert new intermediate states between two states that may lead to unacceptable large control gain.</sentence>
    <sentence>These new intermediate states would smooth the original state sequence produced by the PSO algorithm.</sentence>
    <sentence>However, this procedure may prolong the regulation time as well.</sentence>
    <sentence>Therefore, we propose a reshuffle procedure below, in order to reduce the requests of the insertion procedure as less as possible.</sentence>
    <sentence>Consider the sequence {xk} produced by PSO in an ESC loop.</sentence>
    <sentence>First, we simply choose the nearest state to x1 from {xk} as x2, then we choose the nearest state to x2 from the remainder states in {xk} as x3, and so on.</sentence>
    <sentence>Repeating the procedure will lead to a new sequence that each distance of the first k − 1 states are minimal.</sentence>
    <sentence>The distance of the last two state, i.e.</sentence>
    <sentence>xk+1 and xk may be very large.</sentence>
    <sentence>Moreover, there may still be some unacceptable large distances in the reshuffled sequence {x1, x2, …, xk−1}.</sentence>
    <sentence>However, the requests of the insertion procedure are much less than the original sequence.</sentence>
    <sentence>By combination of the reshuffle procedure and the insertion procedure above, we have the following algorithm.</sentence>
    <sentence>Algorithm 4 Reshuffle-then-Insertion algorithm for PSOESC Step (1) Obtain the distances di,j according to (22).</sentence>
    <sentence>Step (2) Let the last state of the last ESC loop be the basis point x1.</sentence>
    <sentence>Step (3) Find the state nearest to the basis point x1 in the sequence , and let the point be x2.</sentence>
    <sentence>Step (4) Delete the state obtained in step 2) from .</sentence>
    <sentence>Step (5) Compute the distance d1,2 between x1 and x2.</sentence>
    <sentence>Step (6) If d1,2 &gt; Σ, then insert a new state into x1 and, and let the new state be x2, then, let the original x2 be x3.</sentence>
    <sentence>Step (7) Repeat step 5 and 6, until d1,2 &gt;Σ, every time add 1 to the index of every point in the new sequence after x2.</sentence>
    <sentence>Step (8) Let the last point, i.e.</sentence>
    <sentence>the x2 obtained in step 3), be the new basis point, and repeat step 4 ∼7, until the sequence is empty.</sentence>
    <sentence>The result that the Algorithm 4 is applied on a random sequence in the range of [0, 10] is shown in Fig 2.</sentence>
    <sentence>It can be seen that the algorithm smoothes the original sequence remarkably, and the control gain in each step is limited in a predefined bound.</sentence>
    <sentence>Remark 7 Algorithm 4 is also applicable to ESC based other swarm-intelligence-based algorithms, such as Artificial Bee Colony, Ant Colony Swarm and Bacteria Foraging.</sentence>
    <sentence>The regeneration of the target state sequence Fig 2.</sentence>
    <sentence>The regeneration of the target state sequence.</sentence>
    <sentence>The original sequence is built up with 30 random numbers, indexed by k, distributed uniformly in [0, 10].</sentence>
    <sentence>The maximal distance between two neighbors in the original sequence is 7.2183, which is reduced to 3 by the regeneration algorithm.</sentence>
    <sentence>The two inserted intermediate states in the regenerated sequence are indicated by arrows.</sentence>
    <sentence>Then, we have a practical PSOESC scheme as follows.</sentence>
    <sentence>Algorithm 5 PSOESC scheme with reshuffle-then-insertion algorithm Step (1) Initialize the particle swarm, and let i = 1, k = 1.</sentence>
    <sentence>Step (2) regenerate the sequence by Algorithm 4.</sentence>
    <sentence>Step (3) Let particle i’s position as the ith target state, and get the control u by (10).</sentence>
    <sentence>Step (4) The u regulates the plant to the target state, and the performance output y is readily to be measured by sensors.</sentence>
    <sentence>Step (4) Let the output y be the fitness of the ith particle.</sentence>
    <sentence>Step (5) Let i = i+1, repeat 3–4, until i = N′, where N′ is the size of the regenerated sequence.</sentence>
    <sentence>Step (6) Update the velocity and position according to (6) or (8) and 7.</sentence>
    <sentence>Step (7) Let k = k + 1, repeat 2–6, until a stop criterion is met.</sentence>
  </section>
  <section name="Numerical experiments">
    <sentence>The numerical experiments were carried out on a personal computer running on the Matlab/Simulink environment.</sentence>
    <sentence>The parameters of the standard PSO were chosen as w = 0.9, c1 = 0.12, and c2 = 0.012.</sentence>
    <sentence>For the purpose of simulation, performance functions were provided explicitly, while they would be unknown in real-world applications.</sentence>
    <sentence>As mentioned above, the convergence of the PSOESC scheme is described in mean square sense, and the convergence to the global optima is not guaranteed by the standard PSO.</sentence>
    <sentence>Therefore, the given illustrations are typical results obtained by numerous simulations.</sentence>
    <sentence>We define the success rate of the PSOESC scheme as Rc = Nc/Nt, where Nc is the number of times PSOESC converged to the known global optima, and Nt the number of repeated test times.</sentence>
    <sentence>In practical applications, the measurement noise, unmodeled dynamics, input disturbance, and computational error are inevitable, so the convergence to the precise optima is unnecessary.</sentence>
    <sentence>We define the error limit as ±0.05J∗, where J∗ is the known global minimal value.</sentence>
    <sentence>First-order single-input–single-output (SISO) LTI system We first considered a LTI system (25) with the performance function defined as (26) where u is the control obtained by (10).</sentence>
    <sentence>The plot of J(θ) in the range of [0, 1] is illustrated in Fig 3.</sentence>
    <sentence>Obviously, there are two local minima in [0, 1].</sentence>
    <sentence>The two minima 0.225, 0.883 can be easily found by the optimtool toolbox in Matlab by choosing different start point, and the function value according to the two minima are −0.080 and −0.308, respectively.</sentence>
    <sentence>When setting the population size as 10 particles, we observed a 100% success rate in 120 repeated tests.</sentence>
    <sentence>We also tested a swarm with only 2 particles, and have a success rate of 82% with much less steps for convergence than that of 10 particles cases.</sentence>
    <sentence>This is shown in Fig 4.</sentence>
    <sentence>The plot of the function J(θ)=−0 Fig 3.</sentence>
    <sentence>The plot of the function J(θ) = −0.4sin(9θ)sin(θ) in [0, 1].</sentence>
    <sentence>PSOESC for the first-order LTI system, where k indicates the iteration steps Fig 4.</sentence>
    <sentence>PSOESC for the first-order LTI system, where k indicates the iteration steps.</sentence>
    <sentence>By comparison, the performance of NOESC is dependent on the initial point.</sentence>
    <sentence>It would convergence rather fast provided a good initial point was chosen.</sentence>
    <sentence>However, if we choose θ0 = 0 as the initial point, for example, the seeking procedure would converge to the local minimum 0.225.</sentence>
    <sentence>Second-order LTI system Consider a system which has been discussed in Zhang and Ordonez (2007): (27) (28) The performance function (28) is also known as Rosenbrock function whose minimum is x∗ = [1 1]T, and J(x∗) = 0.</sentence>
    <sentence>In this case, we use 10 particles, and the result is shown in Fig 5, where it can be seen that the PSOESC drives the performance function converge to the minimum successfully.</sentence>
    <sentence>To test the robustness of the PSOESC, we disturbed y with a random number uniformly distributed with amplitude 0.2.</sentence>
    <sentence>As Fig 6 shows, the PSOESC scheme drives the state of the system approaching to the optimal set point successfully, which is consistent with the stability analysis of swarms in noisy environment (Liu &amp; Passino, 2004).</sentence>
    <sentence>PSOESC for the second-order LTI system Fig 5.</sentence>
    <sentence>PSOESC for the second-order LTI system.</sentence>
    <sentence>The performance function is the Rosenbrock function.</sentence>
    <sentence>The size of the particle swarm is 15.</sentence>
    <sentence>PSOESC for the second-order LTI system with measurement noise Fig 6.</sentence>
    <sentence>PSOESC for the second-order LTI system with measurement noise.</sentence>
    <sentence>PSOESC for ABS design Consider a one wheel ABS design case which is usually used in ESC literatures (Zhang &amp; Ordonez, 2006, 2007).</sentence>
    <sentence>The problem can be modeled as (Zhang &amp; Ordonez, 2007) (29) (30) where v denotes the linear velocity, ω is the angular velocity, N = Mg is the weight of the wheel, R is the radius of the wheel, I the moment of inertia of the wheel, Bω the braking friction torque, u braking torque, μ(λ) the friction force coefficient, and is the slip, 0 ⩽ λ ⩽ 1 for ωR ⩽ v. There exists a maximum μ∗ for the friction force coefficient μ(λ) at the optimal slip λ∗.</sentence>
    <sentence>The main challenge in designing ABS systems is to devise a robust control scheme that can handle the uncertainty due to environment, for the reason that λ∗ and μ∗ will change as the road condition changes.</sentence>
    <sentence>Now, the design purpose is to device a control u such that maximize the μ(λ).</sentence>
    <sentence>Since the can be measured by an acceleration sensor, we can let the control be (31) such that transform the system (29) and (30) into the form (32) where η is the regulator devised according to (10), and (33) where λk+1 is the target state produced by the PSO algorithm applied in ESC loop.</sentence>
    <sentence>In the simulation, the parameters were chosen as (Zhang &amp; Ordonez, 2007): M = 400 kg, B = 0.01, R = 0.2 m , λ(0) = 0, a = 1, δk = 0.5.</sentence>
    <sentence>For the simulation purpose, we also postulated that the relation of μ(λ) and λ satisfies (34) where, μ∗ = 0.25, λ∗ = 0.6.</sentence>
    <sentence>Obviously, the optimal λ of (34) is λ∗ = 0.6.</sentence>
    <sentence>PSOESC scheme with 10 particles worked well, and we observed a 99% convergence rate in 120 repeated tests.</sentence>
    <sentence>We also tested a swarm with only a single particle, and have a convergence rate of 61%.</sentence>
    <sentence>This is shown in Fig 7.</sentence>
    <sentence>To test the robustness of the PSOESC, we added on μ a random disturbance with uniform distribution in the range of [−0.2, 0.2] to simulate the influence of noises.</sentence>
    <sentence>As Fig 8 shows, the PSOESC scheme drives the state of the system converging to the optimal slip.</sentence>
    <sentence>By comparison, as Fig 9 shows, the NOESC scheme, which is based on the simplex search method in our experiment, converges fast to the optimal slip when no measurement noises are added, whereas it converges to the wrong point when measurement is disturbed by noise,.</sentence>
    <sentence>A single particle-based ESC for the ABS problem Fig 7.</sentence>
    <sentence>A single particle-based ESC for the ABS problem.</sentence>
    <sentence>PSOESC for the ABS with measurement noises Fig 8.</sentence>
    <sentence>PSOESC for the ABS with measurement noises.</sentence>
    <sentence>NOESC for the ABS without measurement noises (top), and with measurement noises… Fig 9.</sentence>
    <sentence>NOESC for the ABS without measurement noises (top), and with measurement noises (bottom).</sentence>
    <sentence>PSOESC for a system with incontinuous performance function Finally, we discuss a LTI system with a discontinuous performance function.</sentence>
    <sentence>Consider the system (20) with performance function defined as (35) The plot of this function in range [0, 1] is illustrated in Fig 10.</sentence>
    <sentence>The PSOESC scheme drives the performance output of the system converge to the optima, as Fig 11 shows.</sentence>
    <sentence>This test illustrates the intrinsic advantage of the PSOESC in solving discontinuous optimization problems.</sentence>
    <sentence>By comparison, the existing NOESC (Zhang &amp; Ordonez, 2005) is unable to deal with such kind of problems.</sentence>
    <sentence>The plot of function (35) Fig 10.</sentence>
    <sentence>The plot of function (35).</sentence>
    <sentence>PSOESC for a system with discontinuous performance function Fig 11.</sentence>
    <sentence>PSOESC for a system with discontinuous performance function.</sentence>
  </section>
  <section name="Conclusion">
    <sentence>This paper presents a PSO-based ESC scheme that is able to find the optimal set point online.</sentence>
    <sentence>The PSO algorithm produces a sequence converging to the global optima.</sentence>
    <sentence>The sequence serves as a guidance to regulate the state of the plant approaching to the optimal set point.</sentence>
    <sentence>We also propose a reshuffle-then-insertion algorithm that is able to reduce the control gain and oscillation, thus improving the practicability of PSOESC scheme.</sentence>
    <sentence>The numerical experiments show the effectiveness of the scheme.</sentence>
    <sentence>The PSOESC scheme found the global optima successfully in various cases.</sentence>
    <sentence>The simulations also demonstrate the ability of PSOESC scheme for handling measurement noise.</sentence>
    <sentence>The disadvantage of PSOESC is that it costs more time in every ESC loop.</sentence>
    <sentence>However, the robustness to measurement noise makes PSOESC preferred to NOESC in some cases.</sentence>
    <sentence>The scheme proposed in this paper will be easily extend to other swarm intelligence-based algorithms, such as Artificial Bee Colony, Ant Colony Optimization and Bacteria Foraging Algorithm.</sentence>
  </section>
</article>

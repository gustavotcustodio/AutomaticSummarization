Predicting seminal quality with artificial intelligence methods

Abstract

Fertility rates have dramatically decreased in the last two decades, especially in men. It has been described that environmental factors, as well as life habits, may affect semen quality. Artificial intelligence techniques are now an emerging methodology as decision support systems in medicine.

In this paper we compare three artificial intelligence techniques, decision trees, Multilayer Perceptron and Support Vector Machines, in order to evaluate their performance in the prediction of the seminal quality from the data of the environmental factors and lifestyle.

To do that we collect data by a normalized questionnaire from young healthy volunteers and then, we use the results of a semen analysis to asses the accuracy in the prediction of the three classification methods mentioned above.

The results show that Multilayer Perceptron and Support Vector Machines show the highest accuracy, with prediction accuracy values of 86% for some of the seminal parameters. In contrast decision trees provide a visual and illustrative approach that can compensate the slightly lower accuracy obtained.

In conclusion artificial intelligence methods are a useful tool in order to predict the seminal profile of an individual from the environmental factors and life habits. From the studied methods, Multilayer Perceptron and Support Vector Machines are the most accurate in the prediction. Therefore these tools, together with the visual help that decision trees offer, are the suggested methods to be included in the evaluation of the infertile patient.

Keywords
Artificial neural network
Support Vector Machines
Decision trees
Diagnosis
Decision support system
Expert system
Semen quality
Male fertility potential

1. Introduction

After the publication of a meta-analysis directed by Elisabeth Carlsen (Carlsen, Giwercman, Keiding, & Skakkebaek, 1992), there is a debate about a possible decline in semen quality. Numerous studies show a decrease in semen parameters during the past two decades (Auger, Kunstmann, Czyglik, & Jouannet, 1995; Splingart et al., 2011; Swan, Elkin, & Fenster, 1997, 2000), affecting the male fertility potential. Between the factors considered to explain this decline, there is an increase in the incidence of male reproductive diseases (Irvine, 2000; Splingart et al., 2011), but also has been suggested the effect of environmental or occupational factors (Giwercman & Giwercman, 2011; Wong, Zielhuis, Thomas, Merkus, & Steegers-Theunissen, 2003), to a certain lifestyle (Agarwal, Desai, & Ruffoli, 2008; Martini, 2004).

To evaluate the male partner, clinicians use the data obtained from semen analysis (Kolettis, 2003), and they compare the obtained results with the corresponding reference value established by World Health Organization (WHO, 1999). Semen analysis is a good predictor of the male fertility potential (Bonde et al., 1998; Guzick et al., 2001; Slama et al., 2002; Zinaman, Brown, Selevan, & Clegg, 2000), and is also necessary to evaluate candidates to become semen donors (Barratt, Clements, & Kessopoulou, 1998; Carrell, Cartmill, Jones, Hatasaka, & Peterson, 2002; Ecochard, Cottinet, Mathieu, Rabilloud, & Czyba, 1999; Society British Andrology, 1999). There is a high variability in the testicular function of an individual (Keel, 2006), so it is recommended to interpret the results taking in account certain factors (i.e., fever, toxic exposure) that can modify the semen parameters (Rowe & Comhaire, 2000).

In this paper, assuming the influence of environmental factors and life habits in semen quality, we compare the prediction accuracy of three different artificial intelligence (AI) methods, Multilayer Perceptron (MLP), Support Vector Machines (SVM) and decision trees (DT), to determine the best Decision Support Systems (DSS) that can help in the evaluation of male fertility potential.

The current advances and progresses in the field of AI have led to the emergence of expert systems and DSSs for economics, linguistics, management science, mathematical modelling, psychology, etc.

There are good classifiers in the AI such as artificial neural network (ANN), DT (Polat & Gnes, 2009b), SVM (Conforti & Guido, 2010) or even hybrid methods that combine ANNs and fuzzy logic into fuzzy neural networks (FNN) (Kahramanli & Allahverd, 2008) which are widely used to aid medical diagnosis by means of decision support systems construction.

Moreover, the use of AI has also become widely accepted in medical applications. These methods include advantages as (a) Ease of optimisation, resulting in cost-effective and flexible non-linear modelling of large data sets; (b) Accuracy for predictive inference, with potential to support clinical decision making; (c) These models can make knowledge dissemination easier by providing explanation, for instance, using rule extraction or sensitivity analysis (Lisboa & Taktak, 2006).

The amount of information used in order to predict the male fertility potential makes really useful the application with AI methods not only for improving the accuracy but also to select the best features as, very often, the number of feature to deal with is huge (Gil & Johnsson, 2010a, 2010b, 2011; Gil, Johnsson, Garcia Chamizo, Paya, & Fernandez, 2009, 2011; Polat & Gnes, 2009a; Subashini, Ramalingam, & Palanivel, 2009). This will lead to the knowledge discovery in databases, data mining or the process of extracting patterns from large data sets.

The main objective of this paper is to compare a number of classification methods applied to male fertility data sets. The approach chosen to address the problem is by the use of different AI methods, in particular DT, MLP and SVM. A comparative study of those will give us insight into the merits of the different methods when used on this problem.

The remaining part of the paper is organized as follows: First we start defining the materials and methods of the study (study population and the variables of the questionnaire). Then we continue with a brief description of the AI methods used in this paper: MLP, SVM and DT. Then we proceed by describing the design of our proposal and the experiments carried out in the result section; the available data as well as a detailed explanation of the different values of our database; Then we continue by describing the subsequent testing carried out in order to analyse the results; Finally we draw the relevant conclusions.
2. Materials and methods
2.1. Study population

The study was performed with young healthy volunteers among the students of the University of Alicante. 100 volunteers’ between 18 and 36 years old participated in the study. After being informed they were asked to provide a semen sample after 3 to 6 days of sexual abstinence, and a semen analysis according to World Health Organization (WHO) guidance was performed. Those with previous known reproductive alterations (i.e., Varicocele) were excluded of the statistical analysis.
2.2. Variables of the questionnaire

On the day of the analysis, the volunteers were asked to fulfill a questionnaire about life habits and health status. Table 1 shows the name, a description and the range of values of the variables used in the study as well as the values normalized. Table 1 shows the treatment we have done to the different database input fields. We have converted the input data into a range of normalization according to the follow rules:

(a)

    Numerical variables such as age, Year of analysis, the number of exposures or Average number of cigarettes per day are normalized onto the interval (0, 1). For instance the average number of cigarettes per day is indicated in the second column (Values) as a range between the minimum 0 and the maximum 25. This means that the persons that consumes 25 cigarettes is normalized to the value 25/25 = 1 whereas an individual that consumes 14 cigarettes per day is normalized to the value 14/25 = 0.56
(b)

    The variables with only two independent attributes are prearranged with binary values (0, 1). We have many of those representations.
(c)

    The variables with three independent attributes, such as “Vaccines received”, “High fevers in the last year” and “Smoking habit” are prearranged using the ternary values (−1, 0, 1). For example, the last one “Smoking habit” will take −1 for never, 0 represents occasional and 1 daily.
(d)

    The variables with four independent attributes, such as “Season in which the analysis was performed” or “Marital status” are prearranged using the four different and equal distance values (−1, −0.33, 0.33, 1). For instance, “Marital status” will take −1 unmarried and without a partner, −0.33 represents unmarried with partner, 0.33 is the value married and 4 for something else.

Table 1. List of variables with their descriptions and their values range.
Variable description	Values (min–max)	Normalized
Season in which the analysis was performed.	(1) winter, (2) spring, (3) Summer, (4) fall	(−1, −0.33, 0.33, 1)
Age at the time of analysis.	18–36	(0, 1)
Body mass index (BMI)	17–34	(0, 1)
Marital status	(1) Unmarried and without a partner, (2) unmarried with partner, (3) married, (4) other.	(−1, −0.33, 0.33, 1)
Children	(1) Yes, (2) no	(0, 1)
Birth city	(1) Alacanti (2) marina baixa, (3) marina alta, (4) the Comtat, (5) l’Alcoy, (6) l’alt Vinalopo, (7) el vinalopo Mitj, (8) baix Vinalopo, (9) la vega baja, (10) other cities.	(0, 1)
City of the family home	(1) Alacanti (2) marina baixa, (3) marina alta, (4) the Comtat, (5) l’Alcoy, (6) l’alt Vinalopo, (7) el vinalopo Mitj, (8) baix Vinalopo, (9) la vega baja, (10) other cities.	(0, 1)
City of residence during the course	(1) Alacanti (2) marina baixa, (3) marina alta, (4) the Comtat, (5) l’Alcoy, (6) l’alt Vinalopo, (7) el vinalopo Mitj, (8) baix Vinalopo, (9) la vega baja, (10) other counties.	(0, 1)
Number of siblings.	0–6	(0, 1)
Birth defect, genetic disorder or any hereditary disease	(1) Yes, (2) no	(0, 1)
Childish diseases (i.e., chicken pox, measles, mumps, polio)	(1) Yes, (2) no	(0, 1)
Vaccines received	(1) Children calendar, (2) i Children calendar and tetanus, (3) only tetanus.	(−1,0,1)
Allergy	(1) Yes, (2) no	(0, 1)
Accident or serious trauma	(1) Yes, (2) no	(0, 1)
Surgical intervention	(1) Yes, (2) no	(0, 1)
Significant diseases	(1) Yes, (2) no	(0, 1)
High fevers in the last year	(1) less than three months ago, (2) more than three months ago, (3) no	(−1,0,1)
Chemotherapy	(1) Yes, (2) no	(0, 1)
Radiations (i.e., X-rays)	(1) Yes, (2) no	(0, 1)
Time since radiation exposure	(1) Less than 3 months, (2) More than 3 months.	(0, 1)
Number of exposures	0–20	(0, 1)
Frequency of alcohol consumption	(1) several times a day, (2) every day, (3) several times a week, (4) once a week, (5) hardly ever or never	(0, (1)
Alcohol consumption	Grams per week (0–312)	(0, 1)
Smoking habit	(1) never, (2) occasional (3) daily.	(−1,0,1)
Average number of cigarettes per day	0–25	(0, 1)
Years of exposure to cigarettes	0–19	(0, 1)
Coffee consumption	(1) none, (2) 1 or 2 coffees a day, (3) 3 to 5 coffees a day, (4) more than 5 coffees a day.	(−1, −0.33, 0.33, 1)
Drugs consumption	(1) Yes, (2) no	(0, 1)
Number of hours spent sitting per day	1–16	(0, 1)
Average hours sleep per day	6–12	(0, 1)
Wearing tight clothes	(1) Yes, 92) no	(0, 1)
Warm baths	(1) Yes, (2) no	(0, 1)
Average hours per week playing sports	0–40	(0, 1)
Average ejaculations per week	1–14	(0, 1)

The variables with a range of more than four independent attributes (i.e., some of them have 10 different values) are considered numerical variables as in the option (a).
2.3. Decision trees

A decision tree is a classifier in the form of a tree structure (see Fig. 1), where each node is either a leaf node, which indicates the value of the target attribute (class) of examples, or a decision node, which specifies some test to be carried out on a single attribute-value, with one branch and sub-tree for each possible outcome of the test.
General scheme of a decision tree

    Download full-size image

Fig. 1. General scheme of a decision tree. This technique is very appreciated for the doctors as it follows similar rules of procedure.

Decision trees are powerful and popular tools for classification and prediction. In contrast to other AI methods, such as MLP and SVM (that both will be explained later), the advantages of decision trees is due to the fact that they represent rules. Rules can readily be expressed so that persons can understand them or even directly used in a database.

In some areas of applications, the accuracy of a classification or prediction is the only thing that matters. In such situations we do not necessarily concern about how the model works. However, in other situations, the ability to explain the reason for a decision, is crucial. For instance, in medicine in general, and to predict the male fertility potential in particular, one has describe the the factors involved, so that other physicians can utilize this knowledge in launching a successful prediction. This domain experts must recognize and approve this discovered knowledge, and for this we need good descriptions.

Modeled after the structure of a tree, decision trees (DTs) are able to provide a good explanation applicable to the life habits of the populations and therefore interpret problems very much according to the principles of mathematical and statistical principles (Risso & Brida, 2010).

A decision tree may be used to classify a given example (see Fig. 1); one begins at the root and follows the path provided by the answers to the questions in the internal nodes until a leaf is reached. The DT algorithm family includes classical algorithms, such as ID3 (Quinlan, 1986), C4.5 (Quinlan, 1993), and CART (Breiman, 1984).

DT is a fairly mature technique which includes models such as C5.0, C&RT, CHAID, QUEST and ID3, the difference of which is in the derivations of formula, such as entropy and information gain, to determine the attributes that result in splitting. However, most decision trees consist of many nodes, which, under certain circumstances, hinder analysis or interpretation of information (Aitkenhead, 2008; Tokatli, Kurt, & Ture, 2009).

The classification and regression trees (CART or C&RT) method of Breiman (1984) generates binary decision trees. In the real world, the chances of biased binary outcomes are few, but the binary method allows for easy interpretation and analysis (Prasher et al., 2003; Tokatli et al., 2009). Thus, the study uses the binary method in the DT to interpret the life habits in prediction of male fertility, and attempts to deduce a correlated prediction factor.
2.4. ANN – multilayer perceptron

An MLP (Bishop, 2005; Haykin, 1998; Ripley, 1996) consists of multiple layers of neurons, generally three (where each layer fully connected to the next one): an input layer that receives external inputs, one hidden layer, and an output layer which generates the classification results (see Fig. 2).
The architecture of the MLP network (input layer, hidden layer and output layer)

    Download full-size image

Fig. 2. The architecture of the MLP network (input layer, hidden layer and output layer). The input layer represents the input data (the input data set is described in Section 3.1). The usage of a hidden layer enables the representation of data sets that are not linearly separable. The output layer represents the classification result and it contains as many outputs as the problem has classes, although here only one neuron is shown. The weights and the threshold of the MLP are calculated during an adaptation process.

Except for the input layer every neuron in the other layers is a computational element with a nonlinear activation function. The principle of the network is that when data are presented at the input layer, the network neurons run calculations in the consecutive layers until an output value is obtained at each of the output neurons. This output will indicate the appropriate class for the input data.

Each neuron (see Fig. 3) in the input and the hidden layers is connected to all neurons in the next layer by weighted connections. The neurons of the hidden layers (see Fig. 3) compute weighted sums of their inputs and adds a threshold. The resulting sums are used to calculate the activity of the neurons by applying a sigmoid activation function.
A neuron in the hidden or the output layer in the MLP

    Download full-size image

Fig. 3. A neuron in the hidden or the output layer in the MLP. In the experimentation section the number of hidden neurons of the MLP will be established.

This process is defined as follows:
(1)
where νj is the linear combination of inputs x1, x2, … ,xp, and the threshold θj, wji is the connection weight between the input xi and the neuron j, and fj is the activation function of the jth neuron, and yj is the output. The sigmoid function is a common choice of activation function. It is defined as:
(2)

A single neuron in the MLP is able to linearly separate its input space into two subspaces by a hyperplane defined by the weights and the threshold. The weights define the direction of this hyperplane whereas the threshold term θj offsets it from origo.

In order to train the MLP we use a supervised learning method denominated backpropagation (Rumelhart, Hinton, & Williams, 1986), which is a gradient descent method, for the adaptation of the weights. This means the network is presented with input examples as well as the corresponding desired output. This algorithm runs as follows:

All the weight vectors w are initialized with small random values from a pseudorandom sequence generator. Then and until the convergence (i.e., when the error E is below a preset value) we repeat the three basic steps:

•

    The weight vectors wi are updated by
    (3)

•

    Where
    (4)

•

    Compute the error E(t + 1), where t is the iteration number, w is the weight vector, and η is the learning rate.

The backpropagation algorithm adapts the weights and the thresholds of the neurons in a way that minimizes the error function E
(5)

where yp is the actual output and dp the desired output for input pattern p.

The minimization of E can be accomplished by gradient descent, i.e., the weights are adjusted to change the value of E in the direction of its negative gradient. The exact updating rules can be calculated by applying derivatives and the chain rule (for the weights between the input and the hidden layer).
2.5. Support Vector Machines

In this section, the basic concept of SVM will be briefly described. More thorough descriptions can be found in (Burges, 1998; Hsu, Chang, & Lin, 2003; Theodoridis & Koutroumbas, 2008). A typical two class problem as Fig. 4 shows is similar to the problem of diagnosing urological patients as either ill or healthy.
The mapping between input space and feature space in a two class problem with…

    Download full-size image

Fig. 4. The mapping between input space and feature space in a two class problem with the SVM. Mapping the training data non-linearly into a higher dimensional feature space via function φ. H1 and H2 are parallel since they have the same normal w and perpendicular distance from the origin, ∣±1 − b∣/∥w∥, and that no training points fall between them. The support vectors are the gray triangles and circles respectively located on H1 and H2. The distance from w to these support vectors is 1/∥w∥ and the margin is simply 2/∥w∥.

For a two class classification problem, it is necessary to first try to estimate a function
using training data, which are l N-dimensional patterns xi and class labels yi, where
(6)

such that f will classify new samples (x,y) correctly.

Given this classification problem the SVM classifier, as described by Vapnik (1995), Guyon, Boser, and Vapnik (1992) and Cortes and Vapnik (1995), satisfies the following conditions:
(7)
which is equivalent to
(8)
Here training vectors xi are mapped into a higher dimensional space by the function φ. The equations of (2) construct a hyperplane wTφ(xi) + b = 0 in this higher dimensional space that discriminates between the two classes showed in Fig. 4. Each of the two half-spaces defined by this hyperplane corresponds to one class, H1 for yi = +1 and H2 for yi = −1. Therefore the SVM classifier corresponds to decision functions:
(9)

Thus the SVM finds a linear separating hyperplane with the maximal margin in this higher dimensional space. The margin of a linear classifier is the minimal distance of any training point to the hyperplane which is the distance between the dotted lines H1 and H2 and the solid line showed in Fig. 4. The points x which lie on the solid line satisfy wTφ(xi) + b = 0, where w is normal to the hyperplane, ∣b∣/∥w∥ is the perpendicular distance from the hyperplane to the origin, and ∥w∥ is the Euclidean norm of w. 1/∥w∥ is the shortest distance from the separating hyperplane to the closest positive (negative) example. Therefore, the margin of a separating hyperplane will be 1/∥w∥ + 1/∥w∥. To calculate the optimal separating plane is equivalent to maximizing the separation margin or distance between the two dotted lines H1 and H2.

It has to be considered that H1: wTφ(xi) + b = 1 and H2: wTφ(xi) + b = −1 are parallel since they have the same normal w and perpendicular distance from the origin, ∣1 − b∣/∥w∥ for H1 and ∣ −1 − b∣/∥w∥ for H2, and that no training points fall between them. Thus we expect the solution for a typical two dimensional problem to have the form shown in Fig. 4. Those training points which gives equality in (3) are lying on one of the hyperplanes H1 and H2 are called support vectors and they are indicated in Fig. 4 by means of a gray color.

In practice, a separating hyperplane may not exist, i.e., if a high noise level causes a large overlap of the classes. To allow for the possibility of examples violating the edges of the margin (when perfect separation is not possible) (Martin, Fowlkes, & Malik, 2003), one introduces slack variables (Bennett & Mangasarian, 1992; Cortes & Vapnik, 1995; Scholkopf, Smola, Williamson, & Bartlett, 2000; Vapnik, 1995).
(10)
in order to relax the constraints to
(11)
Fig. 4 shows the basic idea of SVM, which is to map the data into some other dot product space (called the feature space) F via a nonlinear map
(12)
and perform the above linear algorithm in F. As can be seen, this only requires the evaluation of dot products.
(13)

Clearly, if F is high-dimensional, this approach is not feasible and we have to find a computationally cheaper way. The key observation then is to substitute it for a simple kernel K that can be evaluated efficiently. Kernel substitution is a method for using a linear classifier algorithm to solve a non-linear problem by mapping the original non-linear observations into a higher-dimensional space (as it is indicated in Fig. 4), where the linear classifier is subsequently used; this makes a linear classification in the new space equivalent to non-linear classification in the original space. That transformation is done using Mercer’s theorem (Williamson, Smola, & Scholkopf, 2001), which states that any continuous, symmetric, positive semi-definite kernel function K(x, x′) can be expressed as a dot product in a high-dimensional space.

In that point the tools to construct nonlinear classifiers are defined. We substitute Φ(xi) for each training example xi, and perform the optimal hyperplane algorithm in F. Because we are using kernels, we will thus end up with nonlinear decision function of the form
(14)

where K(x, x′) is called the Kernel function, whose value is equal to the inner product of two vectors x and x′ in the feature space; namely, K(x, x′) = φ(x)Tφ(x′). Through the Kernel function, all computations are performed in the low-dimensional input space. Any function that satisfies the Mercers condition (Courant & Hilbert, 1953) can be used as the Kernel function.

There are many possibilities to define a function to be used as a Kernel. However, typical examples of kernels used in SVM, which have been successfully applied to a wide variety of applications, are linear, polynomials, radial basic functions and hyperbolic tangent:
(15)
(16)
(17)
(18)

3. Experimentation
3.1. Semen parameters

The semen analysis procedures are standardized by a WHO publication (WHO, 1999). This publication establishes the reference value for the different semen parameters and the nomenclature (Eliasson et al., 1970) that describes the deviations from these reference values.

This nomenclature includes:

•

    Normozoospermia: all values are over the lower limit.
•

    Asthenozoospermia: percentage of progressively motile spermatozoa below the lower reference limit.
•

    Oligozoospermia: total number of spermatozoa below the lower reference limit.
•

    Teratozoospermia: percentage of morphologically normal spermatozoa below the lower reference limit.

Of all men surveyed, almost 38% had some alteration in sperm parameters. By studying in detail the individuals with altered parameters the most frequently found seminal alteration was asthenozoospermia in 47.37% of cases, followed by oligozoospermia in 21.05%. The combined changes astenoteratozoospermia and oligoasthenozoospermia shown a frequency of 10.53% in both cases. 7.89% of individuals with changes in semen parameters showed a oligoasthenoteratozoospermia. Finally, the less frequent alteration was teratozoospermia, present in 2.63% of the cases alterations. In this study we use these laboratory results of the seminal analysis as a control to evaluate the accuracy in the prediction of the diagnosis of the ANN developed. This ANN was only based in the answers to the questionary of the individuals who participate.
3.2. Development of the AI methods
3.2.1. Decision tree

In this section we explain the algorithm C4.5, which is the one we have decided to use for the performance of the decision tree. C4.5 is an extension of the basic ID3 algorithm designed by Quinlan (Quinlan, 1986, 1993) to address some issues not dealt with by ID3, such as avoiding overfitting the data, handling training data with missing attribute values and improving computational efficiency among other less important.

The ID3 algorithm can be summarized as follows:

1.

    Take all unused attributes and count their entropy concerning test samples
2.

    Choose attribute for which entropy is minimum (or, equivalently, information gain is maximum)
3.

    Make node containing that attribute

The decision of choosing DT as the first method is due on one hand that it is the most useful technique for physicians that find on it a similar way that they use in their usual procedure. Furthermore, DT will help us to reduce the number of input data.

Research indicates that application of data dimensionality reduction as a pre-step to the classification procedure does improve the classification accuracy (Fu & Wang, 2003; Raymer, Punch, Goodman, Kuhn, & Jain, 2000). Furthermore, feature selection can also provide a better understanding of the underlying process that generated the data (Guyon & Elisseeff, 2003). It is beneficial, and also demanded in many cases, to limit the number of input features when building classification systems in order to have a good predictive and less computationally intensive model (Zhang, 2000).

Fig. 5 shows the execution carried out with a decision tree. This figure could help to establish what are the fields more important for the output. In fact, once the tree is obtained we have carried out other tests where the input data are reduced to only the fields that appear in the tree of the figure, that in our case are five.
This figure shows the execution carried out with a decision tree

    Download full-size image

Fig. 5. This figure shows the execution carried out with a decision tree. This figure could help to establish what are the fields more important for the output.
3.2.2. MLP

For the construction of the MLP architecture we have proceeded as follows:

(a)

    Layer 1 corresponds directly to the input vector, that is, all the parameters/fields of the input record.
(b)

    Layer 2 (the hidden layer). The number of hidden neurons for this layer is the most elaborated question in the network’s architecture. This number represents a trade off between performance and the risk of over fitting. In fact, the number of neurons in a hidden layer will significantly influence the ability of the network to generalize from the training data to unknown examples (Pal & University of Nottingham, 2002). In order to keep a good generalization and consequently a high accuracy, without getting over fitting, the experiments carried out showed that a low number of neurons for this layer lead to a poor performance for both training and test sets. At the opposite edge, a high number of neurons performs very well for training and test sets, although the risk of over fitting is high. The various tests carried out between these extreme options leads to meet the optimal solution for this layer with 21 neurons.
(c)

    Layer 3 (the output layer) (Classification). It has two outputs for classification/prediction: normal and altered.

The learning algorithm used is backpropagation with adaptive learning rate, constant momentum and an optimized algorithm based on the gradient descent method. The backpropagation training parameters are shown in Table 2.

Table 2. Backpropagation training parameters.
Parameters	Value
Learning rate	0.01
Adaptive learning rate	0.1
Constant momentum	0.2
Epochs	100–1000-10000
Minimum performance gradient	
3.2.3. SVM

In this study, Radial Basis Functions Kernel (RBF) function has been adopted because we believe that it is a suitable choice for our problem. The RBF kernel nonlinearly maps samples into a higher dimensional space. Thus, unlike the linear kernel, it can handle the case when the relation between class labels and attributes is nonlinear.

Furthermore, the linear kernel is a special case of RBF as (Keerthi & Lin, 2003) shows that the linear kernel with a penalty parameter C has the same performance as the RBF kernel with some parameters (C,γ). In addition, the sigmoid kernel behaves like RBF for certain parameters (Lin & Lin, 2003). Moreover, the number of hyperparameters influences the complexity of model selection. The polynomial kernel has more hyperparameters than the RBF kernel. Finally, the RBF kernel has less numerical difficulties. One key point is 0 < Kij ⩽ 1 in contrast to polynomial kernels of which kernel values may go to infinity
or zero

while the degree is large.
4. Results
4.1. Performance

Frequently, the complete data set is divided into two subsets: the training set and the test set. Here, the training set is used to determine the system parameters, and the test set is used to evaluate the diagnosis accuracy and the network generalization. Cross-validation has been widely used to assess the generalization of a network. The cross-validation estimate of accuracy determining by the overall number of correct classifications divided by the total number of examples in the dataset.
(19)
where n is the size of the dataset S, xi is the example of S, yi is the target of xi, and Si is the probable target of xi by the classifier function I. Therefore:
(20)

Specifically, for this study we have applied a ten-fold cross-validation method for the performance assessment of every network. The data has been divided in ten sets (S1, S2, …, S10) and the ten experiments performed are shown in Fig. 6.
Cross validation method

    Download full-size image

Fig. 6. Cross validation method. The cycle simulates the behavior of a wheel turning each of the portion at a time. In other words, for the first experiment we have S2 up to S10 as the training parts and S1 is the test part. This procedure will continue for 10 times; each of them it will permute the 10 different parts.

The test data are chosen randomly from the initial data and the remaining data form the training data. The method is called 10-fold cross validation since this process has been performed ten times. The function approximation fits a function using the training set only. Then the function approximation is asked to predict the output values for the data in the testing set. The errors it makes are accumulated to provide the mean absolute test set error, which is used to evaluate the model.

The method to evaluate these four AI methods is to obtain some measures as classification accuracy, sensitivity, specificity, positive predictive value, negative predictive value and a confusion matrix. A confusion matrix (Kohavi & Provost, 1998) contains information about actual and predicted classifications done by a classification system.

The experimentation has been done three times in order to analyze the predictive value of each one of the seminal parameter studied. The reason to do that is that Sperm Concentration, Motility and Morphology are pathologies which have a different origin. Therefore, the individuals with those different alterations can not be grouped together. This will be exposed in the following three sections.
4.1.1. Sperm concentration

Table 3 shows the confusion matrix provided for our classifiers, the MLP, SVM and DT running a two classes problem: Assisted reproduction database.

Table 3. Definition of the confusion matrix (for the Assisted reproduction dataset) with the values for every measure of the MLP, SVM and DT classifiers. The values of the confusion matrix are normal and altered, where altered means the Sperm concentration parameter.
Actual	MLP	SVM	DT
Predicted	Predicted	Predicted
P	N	P	N	P	N
P	80	5	83	2	82	3
N	9	6	12	3	13	2

In this case represents the values Normal and Altered, where altered means the Sperm concentration parameter. Classification accuracy, sensitivity, specificity, positive predictive value and negative predictive value (represented by the Table 4) can be defined by using the elements of the confusion matrix (Table 3). Every equation has three values according to the classifiers MLP, SVM and DT, respectively.

Table 4. Equations according to the MLP, SVM and DT classifiers.
		MLP (%)	SVM (%)	DT (%)
Classification accuracy (%)	
	86	86	84
Sensitivity (%)	
	94.1	97.7	96.5
Specificity (%)	
	40	20	13.3
Positive predictive value (%)	
	89.9	87.4	86.3
Negative predictive value (%)	
	54.5	60	40

Sperm concentration is the seminal parameter that shows the highest prediction accuracy of the three parameter.
4.1.2. Percentage of motile sperm

Table 5 shows the values Normal and Altered, where altered means the percentage of motile sperm parameter. Classification accuracy, sensitivity, specificity, positive predictive value and negative predictive value (represented by the Table 6) can be defined by using the elements of the confusion matrix (Table 5).

Table 5. Definition of the confusion matrix (for the Assisted reproduction dataset) with the values for every measure of the MLP, SVM and DT classifiers. The values of the confusion matrix are normal and altered, where altered means percentage of motile sperm parameter.
Actual	MLP	SVM	DT
Predicted	Predicted	Predicted
P	N	P	N	P	N
P	60	11	70	1	58	13
N	16	13	23	6	17	12

Table 6. Equations according to the MLP, SVM and DT classifiers.
		MLP (%)	SVM (%)	DT (%)
Classification accuracy (%)	
	73	76	70
Sensitivity (%)	
	84.5	98.6	81.7
Specificity (%)	
	44.8	20.7	41.4
Positive predictive value (%)	
	79	75.3	77.3
Negative predictive value (%)	
	54.2	85.7	48

Although the accuracy of motility is slightly lower than concentration we can also predict it with a significant accuracy.
4.1.3. Normal morphology

Table 7 shows the values Normal and Altered, where altered means the Normal morphology parameter. Classification accuracy, sensitivity, specificity, positive predictive value and negative predictive value (represented by the Table 8) can be defined by using the elements of the confusion matrix (Table 7).

Table 7. Definition of the confusion matrix (for the Assisted reproduction dataset) with the values for every measure of the MLP, SVM, and DT classifiers. The values of the confusion matrix are normal and altered, where altered means Normal morphology parameter.
Actual	MLP	SVM	DT
Predicted	Predicted	Predicted
P	N	P	N	P	N
P	67	25	68	24	66	26
N	6	2	7	1	7	1

Table 8. Equations according to the MLP, SVM and DT classifiers.
		MLP (%)	SVM (%)	DT (%)
Classification accuracy (%)	
	69	69	67
Sensitivity (%)	
	72.8	73.9	71.7
Specificity (%)	
	25	12.5	12.5
Positive predictive value (%)	
	91.8	90.7	90.4
Negative predictive value (%)	
	7.4	4	3.7

Although the accuracy of motility is slightly lower than concentration we can also predict it with a significant accuracy.

Morphology seems to be less associated with environmental factors and life habits than the previous two seminal parameters.

In general, the values for specificity and Positive predictive value present lower accuracy. This happens even when the classification and the confusion matrix are good. The explanation is in the unbalanced classes. The altered output has always much less registers than the normal ones.

The excellent results provided in Table 3 by means of the confusion matrix as well as the equations of classification accuracy, sensitivity, specificity, positive predictive value and negative predictive value lead us to a convergence which is proposed in Fig. 7. This figure represents two options of diagnosis: laboratory and AI approach. This former one is easier (and especially more comfortable and cheaper) since it is only necessary to fill a questionnaire, besides it could be used as a first step to decide whether or not it is useful to do the laboratory approach.
This figure represents how it is possible to reach a diagnosis either with a…

    Download full-size image

Fig. 7. This figure represents how it is possible to reach a diagnosis either with a laboratory approach, which include expensive tests, sometime uncomfortable for the patients, or with an AI approach, which is easier since it is only necessary to fill a questionnaire. Sometimes, this former approach could be a first step to decide whether or not is useful to do the laboratory approach.
5. Discussion

In this paper, we have evaluated the performance of three AI methods, DT, MLP and SVM, and its application in the prediction of the male fertility potential. Based on the data obtained from 100 volunteers between 18 and 36 years we show the relationship of life habits and environmental factors with semen parameters.

The results have established that all these techniques achieve a high accuracy regarding the different measurement parameters. Specificity and positive predictive value present lower percentages, even when the classification and the confusion matrix are good. The possible explanation of this is that the study population shows an imbalanced distribution (Sun, Kamel, Wong, & Wang, 2007), and there are a bigger number of individuals with normal semen parameters than the ones with alterations.

In general MLP and SVM are the methods that achieve the highest accuracy, being SVM the one with the higher Sensitivity whereas MLP obtains superior Specificity values. Therefore, these two methods seem to be useful tools for the predictions of the seminal parameters from environmental factors and life habits, especially because of their generalization potential with new registers. However, the slightly lower accuracy of DT is compensated by some advantages, such as to be simple (in a visual and illustrative way) to understand and interpret. In general, people are able to understand decision tree models after a brief explanation. It requires little data preparation. Other techniques often require data normalization. In addition, in this paper DT has been used also as a first step in data preprocessing in order to reduce the input data. After this phase, MLP as well as SVM have carried out tests with a lower number of input data.

ANN has been used, in the field of reproductive biology, to predict the results of IVF/ICSI (Kaufmann, Eastaugh, Snowden, Smye, & Sharma, 1997; Kshirsagar et al., 2005; Wald et al., 2005), to assess sperm morphology (Linneberg, Salamon, Svarer, Hansen, & Meyrowitsch, 1994) and to predict the presence of sperm in testes of men with nonobstructive azoospermia (Ma, Chen, Wang, Hu, & Huang, 2011; Samli & Dogan, 2004). Other previous studies, trying to identify the relationship between environmental factors and semen quality have shown several lacks and limitations. Most of those problems are related to the complexity of the information treated due to its diversity and heterogeneous data types. In our opinion, the problem is that previous works (Li, Lin, Li, & Cao, 2011) have approached the study using linear statistical techniques. In this paper, we develop the use of non linear techniques that may allow a better approach of the complexity of the problem (Almeida, 2002; Cleophas & Cleophas, 2009).

Due to the high accuracy obtained with the different classification methods, they seems to be an alternative to more expensive laboratory tests, at least during the initial moment of the fertility study of the couple, as well as in the selection of semen donors. It is also important to highlight that the study population of this work presents close characteristics to regular candidates to become semen donors (i.e., young male, university students) (Thorn, et al., 2008). These AI methods can also help to make decision in the next steps of the infertility treatment, focusing or not on the male partner and avoiding painful and expensive examinations on the female.

The authors have experience in the field of urology by applying several AI techniques in classification tasks with very good results (Gil & Johnsson, 2010b; Gil et al., 2009, Gil, Johnsson, Garcia Chamizo, Paya, & Fernandez, 2011). This makes it possible to adapt the artificial intelligence to meet the needs of the data analyzed in this study.

In future studies, we will investigate the effect of imbalanced classes on classification performance when developing AI methods, like MLP, SVM and DT, for decision support systems for medical diagnosis (Mazurowski et al., 2008). Moreover, we suggest the use of machine learning methods, as well as data mining, which may provide a more precise correlation between seminal data and the information collected by means of the questionnaires. The authors in association with a Reproductive Fertility Clinic are collecting more amount of data. For this purpose we will create data warehousing where will be easier to merge historical and current data. The benefit of using data warehousing is twofold. On one hand, it will improve the accuracy of our systems. On the other hand, the it will supports performance improvement and it will tend to equilibrate classes.

In conclusion, to our knowledge, this is the first time that MLP, SVM and DT have been compared addressing the problem of the relationship between life habits and semen quality. MLP and SVM show the highest prediction accuracy, with an accuracy of 86% for the sperm concentration and an accuracy between and 73% 76% for the motility. Although morphology seems to be less associated with environmental factors and life habits and probably with a major link to genetic alterations (Yatsenko et al., 2011) it also gets better accuracy with MLP and SVM. The clarity, reduction and simplification of the problem provided by DT must also be highlighted. We also suggest further studies using this methodology to identify those factors that affect specifically to some of the seminal parameters, to provide some recommendations that can improve the male fertility potential.

1

    These authors equally contributed to this work.